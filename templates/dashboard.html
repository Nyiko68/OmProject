<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OmTalent | Student Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-orange: #e27327;
            --brand-dark: #1a1a1a;
            --bg-light: #ffffff;
            --sidebar-bg: #2b2b2b; 
            --input-border: #e0e0e0;
            --text-main: #1a252f;
            --text-muted: #777;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Poppins', sans-serif; background-color: var(--bg-light); min-height: 100vh; color: var(--text-main); }
        .layout { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar { 
            width: 260px; background-color: var(--sidebar-bg); color: white; padding: 30px 20px; 
            display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 100; 
        }
        .sidebar-logo { text-align: center; margin-bottom: 40px; }
        .sidebar h2 { margin: 0; font-weight: 600; color: #ffffff; font-size: 20px; }
        .sidebar h2 span { color: var(--brand-orange); display: block; font-size: 11px; text-transform: uppercase; }

        nav ul { list-style: none; padding: 0; margin: 0; flex-grow: 1; }
        nav li { padding: 14px 15px; border-radius: 8px; margin-bottom: 8px; cursor: pointer; font-size: 14px; transition: 0.3s; display: flex; align-items: center; gap: 12px; color: rgba(255,255,255,0.7); }
        nav li:hover, nav li.active { background: var(--brand-orange); color: #ffffff; }
        
        .nav-badge { background-color: #ffffff; color: var(--brand-orange); font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 10px; margin-left: auto; }
        .logout-btn { color: rgba(255,255,255,0.5); text-decoration: none; font-size: 14px; padding: 12px; border-radius: 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); transition: 0.3s; margin-top: auto; }
        .logout-btn:hover { background: #e05a00; color: white; }

        /* Main Content */
        .main-content { flex: 1; padding: 40px; margin-left: 260px; }
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); max-width: 1000px; margin-bottom: 25px; border: 1px solid #edf2f7; }
        
        /* Progress Bar */
        .progress-container { background: #f1f5f9; height: 10px; border-radius: 5px; overflow: hidden; margin: 15px 0; }
        .progress-bar { background: var(--brand-orange); height: 100%; transition: width 0.5s ease; }

        /* Course Grid */
        .course-item { background: white; padding: 20px; border-radius: 12px; border: 1px solid var(--brand-orange); margin-bottom: 15px; cursor: pointer; transition: 0.3s; }
        .course-item:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(226, 115, 39, 0.1); }
        .badge { background: #fff3e0; color: var(--brand-orange); padding: 4px 10px; border-radius: 5px; font-size: 11px; font-weight: 700; }

        /* Video Player */
        .module-item { padding: 15px; border: 1px solid #eee; border-radius: 8px; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: space-between; }
        .module-item:hover { background: #fffaf5; border-color: var(--brand-orange); }

        .course-form { display: grid; grid-template-columns: 2fr 1fr 100px; gap: 15px; margin-bottom: 20px; }
        input, select { padding: 12px; border-radius: 8px; border: 1px solid var(--input-border); }
        button { background: var(--brand-orange); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }
    </style>
</head>
<body>

<div class="layout">
    <div class="sidebar">
        <div class="sidebar-logo"><h2>Om Talent <span>by Omniado</span></h2></div>
        <nav>
            <ul>
                <li class="active" onclick="showSection('home')">üè† Dashboard</li>
                <li onclick="showSection('courses')">üìö My Courses</li>
                <li onclick="showSection('materials')">üìÑ Study Materials</li>
                <li onclick="showSection('messages')">‚úâÔ∏è Messages <span class="nav-badge" id="msgBadge">2</span></li>
                <li onclick="showSection('profile')">üë§ My Profile</li>
            </ul>
        </nav>
        <a href="/logs" class="logout-btn">Log Out</a>
    </div>

    <div class="main-content">
        <div id="home" class="section active">
            <h1>Welcome Back, {{ student_name }} üëã</h1>
            <div class="stats-grid" style="display:flex; gap:20px;">
                <div class="card" style="flex:1; text-align:center;"><h2 id="courseCount">0</h2><p>Courses</p></div>
                <div class="card" style="flex:1; text-align:center;"><h2 id="avgProgress">0%</h2><p>Avg Progress</p></div>
            </div>
        </div>

        <div id="courses" class="section">
            <div class="card">
                <h1>Enroll in New Course</h1>
                <div class="course-form">
                    <select id="courseInput">
                        <option value="" disabled selected>Select Course</option>
                        <option value="Web Development">Web Development</option>
                        <option value="Design Principles">Design Principles</option>
                        <option value="DevOps">DevOps</option>
                        <option value="Business">Business</option>
                        <option value="Marketing">Marketing</option>
                    </select>
                    <select id="categoryInput">
                        <option value="Coding">Coding</option>
                        <option value="Design">Design</option>
                        <option value="Business">Business</option>
                    </select>
                    <button onclick="addCourse()">Enroll</button>
                </div>
                <div id="courseList"></div>
            </div>
        </div>

        <div id="studyView" class="section">
            <button onclick="showSection('courses')" style="margin-bottom:15px;">‚Üê Back</button>
            <div class="card">
                <h1 id="studyTitle">Course Content</h1>
                <iframe id="mainVideo" width="100%" height="450px" src="" frameborder="0" allowfullscreen style="border-radius:12px; background:#000;"></iframe>
                <div style="margin-top:20px;">
                    <h3>Course Modules</h3>
                    <div id="moduleList"></div>
                    <button onclick="markProgress()" style="width:100%; margin-top:10px; background:#2ecc71;">Mark Current Module as Completed (+20%)</button>
                </div>
            </div>
        </div>

        <div id="materials" class="section">
            <div class="card">
                <h1>Study Materials</h1>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                    <div class="card" style="border:1px solid #eee;">üìï <b>Web Dev Handbook</b><br><a href="#">View</a></div>
                    <div class="card" style="border:1px solid #eee;">üìò <b>Design Guide</b><br><a href="#">Download</a></div>
                </div>
            </div>
        </div>

       <div id="messages" class="section">
    <div class="card">
        <h1>My Messages</h1>
        {% for msg in messages %}
        <div class="card" style="border-left: 4px solid var(--brand-orange); margin-bottom:10px;">
            <b>Admin:</b> {{ msg.content }}
        </div>
        {% endfor %}
    </div>
</div>

        <div id="profile" class="section">
            <div class="card">
                <h1>Student Profile</h1>
                <label>Name</label><input type="text" id="profileUsername" value="{{ student_name }}" style="width:100%; margin-bottom:10px;">
                <label>ID</label><input type="text" id="profileID" value="{{ student_id }}" style="width:100%; margin-bottom:10px;">
                <label>Phone</label><input type="text" id="profilePhone" value="{{ student_num }}" style="width:100%; margin-bottom:10px;">
                <label>Email</label><input type="text" id="profileEmail" value="{{ student_email }}" style="width:100%; margin-bottom:20px;">
                <button onclick="alert('Saved!')">Update Profile</button>
            </div>
        </div>
    </div>
</div>

<script>
    const courseContent = {
        "Web Development": [
            { title: "Module 1: HTML5 Layouts", vid: "https://www.youtube.com/embed/qz0aGYrrlhU" },
            { title: "Module 2: CSS Flexbox", vid: "https://www.youtube.com/embed/1Rs2ND1RYYk" },
            { title: "Module 3: JavaScript Basics", vid: "https://www.youtube.com/embed/W6NZfCO5SIk" }
        ],
        "Design Principles": [
            { title: "Module 1: Color Theory", vid: "https://www.youtube.com/embed/L13ue2f76yc" },
            { title: "Module 2: Typography", vid: "https://www.youtube.com/embed/sByzHoiYFX0" }
        ],
        "DevOps": [
            { title: "Module 1: Docker 101", vid: "https://www.youtube.com/embed/3c-iBn73dDE" },
            { title: "Module 2: Kubernetes", vid: "https://www.youtube.com/embed/scEDHsr3APg" }
        ],
        "Business": [{ title: "Module 1: Strategy", vid: "https://www.youtube.com/embed/3vC8n_YI_No" }],
        "Marketing": [{ title: "Module 1: Digital Marketing", vid: "https://www.youtube.com/embed/nU-IIX3X_No" }]
    };

    let courses = JSON.parse(localStorage.getItem("userCourses")) || [];
    let currentCourseName = "";

    window.onload = renderCourses;

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(id === 'messages') document.getElementById('msgBadge').style.display = 'none';
    }

    function addCourse() {
        const name = document.getElementById("courseInput").value;
        const cat = document.getElementById("categoryInput").value;
        if (name && !courses.some(c => c.name === name)) {
            courses.push({ id: Date.now(), name, category: cat, progress: 0 });
            localStorage.setItem("userCourses", JSON.stringify(courses));
            renderCourses();
        }
    }

    function renderCourses() {
        const list = document.getElementById("courseList");
        list.innerHTML = courses.length === 0 ? "<p>No courses enrolled.</p>" : "";
        let progSum = 0;
        courses.forEach(c => {
            progSum += c.progress;
            list.innerHTML += `
                <div class="course-item" onclick="startStudy('${c.name}')">
                    <span class="badge">${c.category}</span>
                    <div style="font-weight:600; margin:10px 0;">${c.name}</div>
                    <div class="progress-container"><div class="progress-bar" style="width:${c.progress}%"></div></div>
                    <small>${c.progress}% Completed</small>
                </div>`;
        });
        document.getElementById("courseCount").innerText = courses.length;
        document.getElementById("avgProgress").innerText = courses.length ? Math.round(progSum / courses.length) + "%" : "0%";
    }

    function startStudy(name) {
        currentCourseName = name;
        showSection('studyView');
        document.getElementById("studyTitle").innerText = name;
        const list = document.getElementById("moduleList");
        list.innerHTML = "";
        const mods = courseContent[name] || [];
        mods.forEach(m => {
            list.innerHTML += `<div class="module-item" onclick="document.getElementById('mainVideo').src='${m.vid}'">${m.title} <span>‚ñ∂</span></div>`;
        });
        document.getElementById("mainVideo").src = mods.length ? mods[0].vid : "";
    }

    function markProgress() {
        let course = courses.find(c => c.name === currentCourseName);
        if (course && course.progress < 100) {
            course.progress = Math.min(course.progress + 20, 100);
            localStorage.setItem("userCourses", JSON.stringify(courses));
            renderCourses();
            alert("Progress Updated!");
        }
    }
</script>
</body>
</html>